<!DOCTYPE html>

<html>
    <head>
        <title>vlabuk xextan</title>
        <link href="https://xextan.github.io/style.css" rel="stylesheet" />
        <link href="noto.css" rel="stylesheet" />
        <link href="style.css" rel="stylesheet" />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body>
        <header>
            <h1>vlabuk xextan</h1>
            <span class="nobr">
                <input type="checkbox" name="pickle" id="pickle" />
                <label for="pickle">pickle mode</label>
            </span>
            <span class="fill"></span>
        </header>
        <p>
            <a href="https://github.com/Xextan/vlabuk">Github</a> &bull;
            <a href="https://docs.google.com/spreadsheets/d/1eR_NQPv9CY-d9L8y2VW-5YbLbr-_IhpM">Spreadsheet</a> (slowly migrating here)
        </p>
        <input type="text" />
        <p>↑ this will do things soon i promise! in the meantime here's all the words in the database so far</p>
        <div id="results"></div>
        <script src="words.js"></script>
        <script>
            document.getElementById("pickle").addEventListener("change", function() {
                document.documentElement.classList.toggle("pickle");
            });
            for (const entry of dict) {
                document.getElementById("results").append(...[htmlify(entry)]);
            }
            function mkelem(tag, props, children) {
                const element = document.createElement(tag);
                Object.assign(element, props);
                for (const child of children) {
                    if (child) {
                        element.append(child);
                    }
                }
                return element;
            }
            function htmlify(entry) {
                let pos =
                entry.alignment ? " root" :
                    entry.type ? " particle" :
                        entry.gloss ? " compound" :
                            /^.{0,2}[áéíóú]/iu.test(entry.word) || /^..[^ptkln]/.test(entry.word) ? " freeword" : " bad";
                let etym_content = [
                    entry.etymology.word,
                    " ",
                    entry.etymology.translit ? mkelem("i", {}, [entry.etymology.translit]) : null
                ];
                return mkelem("div", {"className": "entry" + pos}, [
                    mkelem("p", {}, [
                        mkelem("b", {}, [entry.word]),
                        " ",
                        entry.type ? mkelem("span", {"className": "type " + entry.type.split(" ")[0]}, [entry.type]) : null,
                        " ",
                    // ]),
                    // mkelem("p", {}, [
                        entry.def,
                        entry.alignment ? " – " + entry.alignment : null
                    ]),
                    entry.notes || entry.semantics || entry.etymology || entry.xo || entry.ko ? mkelem("p", {"className": "more"}, [
                        entry.semantics ? mkelem("p", {}, [
                            mkelem("span", {"className": "h"}, ["Keywords: "]),
                            entry.semantics.join(", ")
                        ]) : null,
                        entry.xo || entry.ko ? mkelem("p", {}, [
                            mkelem("span", {"className": "h"}, ["Derivations: "]),
                            ...[entry.xo ?? "", entry.ko ?? ""].map((e, i) => e ? [
                                mkelem("br", {}, []),
                                mkelem("b", {}, [entry.word + ["xo", "ko"][i]]),
                                " " + e
                            ] : null).flat()
                        ]) : null,
                        entry.notes ? mkelem("p", {}, [
                            mkelem("span", {"className": "h"}, ["Notes: "]),
                            entry.notes
                        ]) : null,
                        entry.etymology ? mkelem("p", {}, [
                            mkelem("span", {"className": "h"}, ["Etymology: "]),
                            entry.etymology.lang,
                            " ",
                            entry.etymology.word ?
                                entry.etymology.link ?? true ? mkelem("a", {"href": url(entry.etymology)}, etym_content) : mkelem("span", {}, etym_content)
                            : null,
                        ]) : null,
                    ]) : null
                ]);
            }
            function url(e) {
                var url;
                if (e.lang == "Loglan") {
                    url = "https://randall-holmes.github.io/Loglan/Dictionary/L-to-E-TDR.html#" + (e.urlform || e.word);
                } else if (e.lang.endsWith("Lojban")) {
                    url = "https://sisku.org?en#" + (e.urlform || e.word);
                } else if (e.lang == "Klingon") {
                    url = "https://klingon.wiki/Word/" + (e.urlform || e.word);
                } else if (e.lang == "Toki Pona") {
                    url = "https://linku.la/?q=" + e.word;
                } else {
                    url = "https://en.wiktionary.org/wiki/" + (e.urlform || e.word);
                }
                return url;
            }
        </script>
    </body>
</html>
